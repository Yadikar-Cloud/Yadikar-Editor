tinymce.PluginManager.add("settings",function(e,t){const n="tinymce_settings";let a=[];const o={language:"en_US",skin:"oxide",fontSize:"14px",contentFontSize:"16px",autosave:!0,autosaveInterval:30,spellcheck:!0};function i(){try{const e=localStorage.getItem(n);return e?{...o,...JSON.parse(e)}:o}catch(e){return console.error("Error loading settings:",e),o}}function s(t){!function(e){try{return localStorage.setItem(n,JSON.stringify(e)),!0}catch(e){return console.error("Error saving settings:",e),!1}}(t)?e.notificationManager.open({text:"Failed to save settings",type:"error",timeout:3e3}):(e.notificationManager.open({text:"Settings saved! Reloading editor...",type:"info",timeout:2e3}),setTimeout(()=>{const n=e.getContent();e.settings.selector;tinymce.remove(),window.initializeTinyMCE(t,n)},500))}function r(){const t=i(),n=[{text:"Small (12px)",value:"12px"},{text:"Medium (14px)",value:"14px"},{text:"Large (16px)",value:"16px"},{text:"Extra Large (18px)",value:"18px"}],o={title:"Editor Settings",size:"normal",body:{type:"tabpanel",tabs:[{name:"general",title:"General",items:[{type:"selectbox",name:"language",label:"Language",items:a.map(e=>({text:e.name,value:e.code}))},{type:"selectbox",name:"skin",label:"Theme",items:[{text:"Light (Oxide)",value:"oxide"},{text:"Dark (Oxide Dark)",value:"oxide-dark"}]},{type:"selectbox",name:"fontSize",label:"UI Font Size",items:n},{type:"selectbox",name:"contentFontSize",label:"Content Font Size",items:n}]},{name:"editor",title:"Editor",items:[{type:"checkbox",name:"spellcheck",label:"Enable spell checker"},{type:"checkbox",name:"autosave",label:"Enable auto-save"},{type:"input",name:"autosaveInterval",label:"Auto-save interval (seconds)",inputMode:"numeric"},{type:"htmlpanel",html:'<p style="color: #666; font-size: 12px; margin-top: 10px;"><strong>Note:</strong> Some changes require editor reload to take effect.</p>'}]}]},buttons:[{type:"cancel",text:"Cancel"},{type:"submit",text:"Apply",primary:!0}],initialData:t,onSubmit:function(t){const n=t.getData();n.autosave&&(!n.autosaveInterval||n.autosaveInterval<10)?e.notificationManager.open({text:"Auto-save interval must be at least 10 seconds",type:"warning",timeout:3e3}):(t.close(),s(n))}};e.windowManager.open(o)}return e.ui.registry.addButton("settings",{text:"Settings",icon:"settings",tooltip:"Editor Settings",onAction:function(){r()}}),e.ui.registry.addMenuItem("settings",{text:"Settings",icon:"settings",onAction:function(){r()}}),e.on("init",function(){!async function(){try{const e=await fetch(t+"/languages.json");a=await e.json()}catch(e){console.error("Failed to load languages:",e),a=[{code:"en_US",name:"English (US)"},{code:"it",name:"Italian"},{code:"es",name:"Spanish"},{code:"fr_FR",name:"French"},{code:"de",name:"German"}]}}()}),window.getTinyMCESettings=i,{getMetadata:function(){return{name:"Settings",url:"http://yoursite.com"}}}});