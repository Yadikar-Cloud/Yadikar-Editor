tinymce.PluginManager.add("screenshot",function(e,t){async function n(){try{if("undefined"==typeof html2canvas)return void e.notificationManager.open({text:"html2canvas library not loaded. Please include it in your page.",type:"error",timeout:5e3});e.notificationManager.open({text:"Generating screenshot...",type:"info"});const t=e.getContent(),n=t+"<p>&nbsp;</p>";e.setContent(n);const o=e.getBody(),r=await html2canvas(o,{backgroundColor:"#ffffff",scale:2,logging:!1,useCORS:!0});e.setContent(t),r.toBlob(function(t){if(t){const n=URL.createObjectURL(t),o=document.createElement("a");o.href=n,o.download="editor-screenshot-"+Date.now()+".png",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(n),e.notificationManager.open({text:"Screenshot saved!",type:"success",timeout:3e3})}else e.notificationManager.open({text:"Failed to create screenshot",type:"error",timeout:3e3})})}catch(t){console.error("Screenshot error:",t),e.notificationManager.open({text:"Failed to create screenshot: "+t.message,type:"error",timeout:5e3})}}return e.ui.registry.addButton("screenshot",{text:"Screenshot",icon:"image",tooltip:"Take a screenshot of the editor content",onAction:function(){n()}}),e.ui.registry.addMenuItem("screenshot",{text:"Screenshot",icon:"image",onAction:function(){n()}}),{getMetadata:function(){return{name:"Screenshot",url:"http://yoursite.com"}}}});