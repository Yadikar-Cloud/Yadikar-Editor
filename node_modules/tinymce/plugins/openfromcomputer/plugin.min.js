tinymce.PluginManager.add("openfromcomputer",function(e,t){let o=null;async function n(){try{if(!window.showOpenFilePicker)return void e.notificationManager.open({text:"File System Access API is not supported in your browser. Please use Chrome, Edge, or Opera.",type:"error",timeout:5e3});const t={types:[{description:"HTML file",accept:{"text/html":[".html",".htm"]}},{description:"Text file",accept:{"text/plain":[".txt"]}},{description:"Markdown file",accept:{"text/markdown":[".md"]}},{description:"Word Document",accept:{"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"]}}],multiple:!1,excludeAcceptAllOption:!0};[o]=await window.showOpenFilePicker(t);const n=await o.getFile(),i=n.name.substring(n.name.lastIndexOf(".")).toLowerCase();let r;if(".html"===i){const t=await n.text();e.setContent(t)}else{if(".docx"===i)r=await window.fileConverter.convertToHtml(n,i);else{const e=await n.text();r=await window.fileConverter.convertToHtml(e,i)}setTimeout(()=>{window.reapplyPageView&&window.reapplyPageView(r)},100)}window.currentLocalFile={handle:o,name:n.name,originalExtension:i}}catch(t){"AbortError"!==t.name&&(console.error("Error opening file:",t),e.notificationManager.open({text:"Failed to open file: "+t.message,type:"error",timeout:5e3}))}}return e.ui.registry.addButton("openfromcomputer",{text:"Open File",onAction:function(){n()}}),e.ui.registry.addMenuItem("openfromcomputer",{text:"Local Device",onAction:function(){n()}}),{getMetadata:function(){return{name:"Open from Computer",url:"http://yoursite.com"}}}});