tinymce.PluginManager.add("savetocomputer",function(e,t){async function o(){try{if(!window.showSaveFilePicker)return void function(){const t=e.getContent(),o=new Blob([t],{type:"text/html"}),n=URL.createObjectURL(o),i=document.createElement("a");i.href=n,i.download="document.html",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n),e.notificationManager.open({text:"File downloaded",type:"success",timeout:3e3})}();const t={suggestedName:"document.html",types:window.getFilePickerTypes(),excludeAcceptAllOption:!0},o=await window.showSaveFilePicker(t),n=await o.createWritable(),i=o.name,a=i.substring(i.lastIndexOf(".")),r=e.getContent();let c;try{c=await window.fileConverter.convert(r,a)}catch(t){return void e.notificationManager.open({text:"Conversion failed: "+t.message,type:"error",timeout:5e3})}Blob,await n.write(c),await n.close(),window.currentLocalFile={handle:o,name:o.name},e.notificationManager.open({text:"Saved: "+o.name,type:"success",timeout:3e3})}catch(t){"AbortError"!==t.name&&(console.error("Error saving file:",t),e.notificationManager.open({text:"Failed to save file: "+t.message,type:"error",timeout:5e3}))}}return e.ui.registry.addButton("savetocomputer",{text:"Save File",onAction:function(){o()}}),e.ui.registry.addMenuItem("savetocomputer",{text:"Local Device",onAction:function(){o()}}),{getMetadata:function(){return{name:"Save to Computer",url:"http://yoursite.com"}}}});