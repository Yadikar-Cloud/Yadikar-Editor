!function(){"use strict";var t=function(t){var e=t;return{get:function(){return e},set:function(t){e=t}}},e=(Object.hasOwnProperty,function(){return e=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},e.apply(this,arguments)}),n=tinymce.util.Tools.resolve("tinymce.PluginManager"),i=tinymce.util.Tools.resolve("tinymce.util.Tools"),o=(tinymce.util.Tools.resolve("tinymce.util.URI"),tinymce.util.Tools.resolve("tinymce.util.XHR"),"SpeechRecognitionStart SpeechRecognitionEnd"),c=function(t,n,c){var r,s,a=(r=function(t){return i.map(function(t){return t.getParam("webspeechapi_languages","English=en,Danish=da,Dutch=nl,Finnish=fi,French=fr_FR,German=de,Italian=it,Polish=pl,Portuguese=pt_BR,Spanish=es,Swedish=sv")}(t).split(","),(function(t){var e=t.split("=");return{name:e[0],value:e[1]}}))}(t),s=[],i.each(r,(function(t){s.push({selectable:!0,text:t.name,data:t.value})})),s),u=function(){n.get()?(n.set(!1),function(t){t.fire("SpeechRecognitionEnd")}(t)):(n.set(!0),function(t){t.fire("SpeechRecognitionStart")}(t))},l={tooltip:"Speech Recognition",onAction:u,icon:"microphone",onSetup:function(e){e.setActive(n.get());var i=function(){e.setActive(n.get())};return t.on(o,i),function(){t.off(o,i)}}},g=e(e({},l),{type:"splitbutton",select:function(t){return t===c.get()},fetch:function(t){t(i.map(a,(function(t){return{type:"choiceitem",value:t.data,text:t.text}})))},onItemAction:function(t,e){c.set(e)}});a.length>1?t.ui.registry.addSplitButton("speechrecognition",g):t.ui.registry.addToggleButton("speechrecognition",l),t.ui.registry.addToggleMenuItem("speechrecognition",{text:"Speech Recognition",icon:"microphone",onSetup:function(e){e.setActive(n.get());var i=function(){e.setActive(n.get())};return t.on(o,i),function(){t.off(o,i)}},onAction:u})};n.add("speechrecognition",(function(e){var n=t(!1),i=t(function(t){var e=t.getParam("language","en-US");return t.getParam("webspeechapi_language",e)}(e));const o=window.SpeechRecognition||window.webkitSpeechRecognition;return c(e,n,i),function(t,e,n,i){const o=new i;let c=!1;o.addEventListener("result",(t=>{for(let e=t.resultIndex,n=t.results.length;e<n;e++)t.results[e].isFinal,tinymce.activeEditor.insertContent(t.results[e][0].transcript)})),o.addEventListener("error",(t=>{})),o.addEventListener("end",(()=>{if(c)try{const t=tinymce.activeEditor.selection.getNode(),e=tinymce.activeEditor.getWin();if(!t||"BODY"===t.nodeName||t.classList.contains("page"))return;const n=e.getComputedStyle(t),i=parseInt(n.lineHeight),c=t.offsetHeight;if(Math.round(c/i)>5){t.parentElement;const e=tinymce.activeEditor.dom.create("p");e.innerHTML="&nbsp;",tinymce.activeEditor.dom.insertAfter(e,t),tinymce.activeEditor.selection.setCursorLocation(e,0),tinymce.activeEditor.focus()}o.start()}catch(t){}})),t.on("SpeechRecognitionStart",(function(){const t=!1;o.lang=n.get(),o.continuous=!0,o.interimResults=t,c=!0;try{o.start()}catch(t){}})),t.on("SpeechRecognitionEnd",(function(){c=!1,o.stop()}))}(e,0,i,o),function(t,e,n){return{markErrors:function(n){markErrors(t,e,n)},getLanguage:n.get}}(e,n,i)}))}();